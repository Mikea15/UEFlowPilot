---
title: FlowPilotComponent.h
description: Reference page for FlowPilotComponent.h
---
import Ref from '../../../components/Ref.astro'
import LinkRef from '../../../components/LinkRef.astro'

import { Image } from 'astro:assets';
import schema from '../../../assets/uflowpilotcomponent.png';
import beginplay from '../../../assets/uflowpilotcomponent_beginplay.png';
import tick from '../../../assets/uflowpilotcomponent_tickcomponent.png';
import startflow from '../../../assets/uflowpilotcomponent_startflow.png';

<Ref c="UFlowPilotComponent" p="UActorComponent" />

## Description

<Image src={schema} alt="UFlowPilotComponent Schema" />

`UFlowPilotComponent` is the base component required to run FlowPilot. It takes a <LinkRef c="UFlowPilot" /> Asset, instances it and runs it.
Most of its methods are exposed to blueprint to allow quick iteration.

`UFlowPilotComponent` also has custom _ExecutionModes_ which can be:
- RunOnce: Runs flow once, wether it succeed or fails
- RunUntilSucceed: Runs flow until it succeeds, then stops
- RunUntilFail: Runs flow until it fails, then stops
- RunWhileSucceed: Runs flow while it succeed. Will stop on failure.
- RunWhileFail: Runs flow while it fails. Will stop on success
- RunNonStop: Runs flow over and over.

There's a _RetryDelay_ to help control how fast should a retry occur.

The Root Task of <LinkRef c="UFlowPilot" /> is a <LinkRef c="UFPTask_Sequence" />, therefore, the execution of `UFlowPilotComponent` is a sequence.

## Implementation Details
### `BeginPlay()`

<Image src={beginplay} alt="UFlowPilotComponent BeginPlay" />

Begin play will setup the initial FlowPilot `RootSequence` with the necessary context. This is run only once.
If `Start on BeginPlay` is ticked, then we enter the first Task. If that result is succeeded we set the flow in progress and start ticking `UFlowPilotComponent`.

### `TickComponent()`

<Image src={tick} alt="UFlowPilotComponent TickComponent" />

During `UFlowPilotComponent`'s TickComponent method, we run `RootSequence`s tick method which in turn will execute its children along the FlowPilot hierarchy, one Task at a time (unless using Parallel Task).
When a task returns a result, `UFlowPilotComponent` parses it and decides if we have to either retry, fail or error.

`RootSequence` will only return to `UFlowPilotComponent` when it has no more Tasks to run. While `RootSequence` has tasks running, its result will stay `InProgress` and `UFlowPilotComponent` will just tick as usual.

### `StartFlow()`

<Image src={startflow} alt="UFlowPilotComponent StartFlow" />

## Class Info
- __FileName:__ `FlowPilotComponent.h`

## Properties

```cpp
// Automatically starts FlowPilot on BeginPlay
UPROPERTY(EditAnywhere, Category=FlowPilot)
uint8 bAutoStartOnBeginPlay : 1;

// FlowPilot Asset.
UPROPERTY(EditAnywhere, Category=FlowPilot)
TObjectPtr<UFlowPilot> FlowPilotAsset;

// Overrides FlowPilotAsset with ExecutionMode
UPROPERTY(EditAnywhere, Category=FlowPilot)
EFlowMode ExecutionMode = EFlowMode::RunOnce;

// Execution Mode retry delay
UPROPERTY(EditAnywhere, Category=FlowPilot, meta=(ClampMin="0.0", EditCondition="ExecutionMode != EFlowMode::RunOnce"))
float RetryDelay = 0.0f;

// FlowPilotLifetimeActors are spawned from FlowPilot, and will auto destroy when Ending

TArray<TWeakObjectPtr<AActor>> FlowPilotLifetimeActors;

```

## Functions

### `SetFlowPilotAsset`
> Sets FlowPilot data asset
```cpp
bool SetFlowPilotAsset(UFlowPilot* InFlowPilotAsset);

```

### `StartFlow`
> Start Current FlowData
```cpp
void StartFlow();

```

### `StopFlow`
> Stops FlowPilot
```cpp
void StopFlow(EFPStopType StopType = EFPStopType::CancelExecution);

```

### `PauseFlow`
> Pauses FlowPilot. Execution must have been started first
```cpp
void PauseFlow();

```

### `UnPauseFlow`
> UnPauses FlowPilot, if Paused.
```cpp
void UnPauseFlow();

```

### `IsPaused`
> Returns true if FlowPilot is Paused
```cpp
bool IsPaused() const { return FlowState == EFlowState::Paused; }

```

### `IsDataSetup`
> Returns true is setup is valid
```cpp
bool IsDataSetup() const { return FlowPilotAsset != nullptr; }

```

### `GetRunState`
> Returns FlowPilot state
```cpp
EFlowState GetRunState() const { return FlowState; }

```

### `IsRunning`
> Returns true if FlowPilot is in Progress
```cpp
bool IsRunning() const { return FlowState == EFlowState::InProgress; }

```

### `FindSingleActor`
> Finds single actor reference
```cpp
AActor* FindSingleActor(const FFlowActorReference& ActorReference);

```

### `FindActors`
> Finds all actors with reference (usually external tags on multiple actors)
```cpp
TArray<AActor*> FindActors(const FFlowActorReference& ActorReference);

```

### `FindSingleActorByTag`
> Finds and Caches Unique Actor via GameplayTag
```cpp
AActor* FindSingleActorByTag(const FGameplayTag& Tag);

```

### `FindActorsByTag`
> Find All Actors by Tag
```cpp
TArray<AActor*> FindActorsByTag(const FGameplayTag& Tag);

```

### `BindToFlowPilotLifetime`
> Binds Lifetime of Actor to FlowPilot. Will destroy when FlowPilot Completes
```cpp
void BindToFlowPilotLifetime(AActor* InActor);

```

### `PrefetchActorReference`
> Will prefect Actor Reference if Referenced via External Tag.
```cpp
void PrefetchActorReference(const FFlowActorReference& ActorReference);

```


## File Info

__FileName:__ `FlowPilotComponent.h`
- __Class List:__ 
[ [`UFlowPilotComponent`](#UFlowPilotComponent) ]


## `UFlowPilotComponent` 


__Parent Classes:__
[ `UActorComponent` ]

 \
FlowComponent \
- Initializes, Maintains and Runs a Flow Data Asset. 

### Properties

```cpp
// Automatically starts FlowPilot on BeginPlay 
UPROPERTY(EditAnywhere, Category=FlowPilot)
uint8 bAutoStartOnBeginPlay : 1;

// FlowPilot Asset. 
UPROPERTY(EditAnywhere, Category=FlowPilot)
TObjectPtr<UFlowPilot> FlowPilotAsset;

// Overrides FlowPilotAsset with ExecutionMode 
UPROPERTY(EditAnywhere, Category=FlowPilot)
EFlowMode ExecutionMode = EFlowMode::RunOnce;

// Execution Mode retry delay 
UPROPERTY(EditAnywhere, Category=FlowPilot, meta=(ClampMin="0.0", EditCondition="ExecutionMode != EFlowMode::RunOnce"))
float RetryDelay = 0.0f;

// FlowPilotLifetimeActors are spawned from FlowPilot, and will auto destroy when Ending 
TArray<TWeakObjectPtr<AActor>> FlowPilotLifetimeActors;

```

### Functions

#### `SetFlowPilotAsset`
> Sets FlowPilot data asset 
```cpp
bool SetFlowPilotAsset(UFlowPilot* InFlowPilotAsset);
```
#### `StartFlow`
> Start Current FlowData 
```cpp
void StartFlow();
```
#### `StopFlow`
> Stops FlowPilot 
```cpp
void StopFlow(EFPStopType StopType = EFPStopType::CancelExecution);
```
#### `PauseFlow`
> Pauses FlowPilot. Execution must have been started first 
```cpp
void PauseFlow();
```
#### `UnPauseFlow`
> UnPauses FlowPilot, if Paused. 
```cpp
void UnPauseFlow();
```
#### `IsPaused`
> Returns true if FlowPilot is Paused 
```cpp
bool IsPaused() const { return FlowState == EFlowState::Paused; }
```
#### `IsDataSetup`
> Returns true is setup is valid 
```cpp
bool IsDataSetup() const { return FlowPilotAsset != nullptr; }
```
#### `GetRunState`
> Returns FlowPilot state 
```cpp
EFlowState GetRunState() const { return FlowState; }
```
#### `IsRunning`
> Returns true if FlowPilot is in Progress 
```cpp
bool IsRunning() const { return FlowState == EFlowState::InProgress; }
```
#### `FindSingleActor`
> Finds single actor reference 
```cpp
AActor* FindSingleActor(const FFlowActorReference& ActorReference);
```
#### `FindActors`
> Finds all actors with reference (usually external tags on multiple actors) 
```cpp
TArray<AActor*> FindActors(const FFlowActorReference& ActorReference);
```
#### `FindSingleActorByTag`
> Finds and Caches Unique Actor via GameplayTag 
```cpp
AActor* FindSingleActorByTag(const FGameplayTag& Tag);
```
#### `FindActorsByTag`
> Find All Actors by Tag 
```cpp
TArray<AActor*> FindActorsByTag(const FGameplayTag& Tag);
```
#### `BindToFlowPilotLifetime`
> Binds Lifetime of Actor to FlowPilot. Will destroy when FlowPilot Completes 
```cpp
void BindToFlowPilotLifetime(AActor* InActor);
```
#### `PrefetchActorReference`
> Will prefect Actor Reference if Referenced via External Tag. 
```cpp
void PrefetchActorReference(const FFlowActorReference& ActorReference);
```
